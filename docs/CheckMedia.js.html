<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: utils/CheckMedia.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: utils/CheckMedia.js</h1>

    


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
 * Copyright (c) 2014 Ian Carson - LinkedIn http://lnkd.in/9qJWap
 *
 * Project : AVObj - Making JS Simple.
 * Version : 0.6.1
 * License : MIT (http://www.opensource.org/licenses/mit-license.php)
 *
 * For the latest updates go to http://AVObject.net
 * Visit the wiki for howto information on getting started at https://github.com/Kabe0/AVObj/wiki
 */

/**
 * Handles media creation
 * @property {object} CheckMedia.events				- Available event types.
 * @class
 *
 */
var CheckMedia = AVObj.extend( { generateSingleton : true } );
CheckMedia.properties =
{

	head : null,															// Location where query nodes are created.

	/**
	 * Avaiable Observer events to listen to.
	 * @memberof CheckMedia
	 * @enum
	 */
	events : {																// List of available events you can listen to (used on the query objects).
		/**
		 * List of some common event types used with Elements.
		 * You may also use the string value instead of the enum value.
		 *
		 * @enum {string}
		 * @memberof CheckMedia
		 * @alias events
		 */
		value :
		{
			ON_TRUE:   "onTrue",
			ON_FALSE:  "onFalse",
			ON_CHANGE: "onChange"
		},
		writable : false,
		configurable : false
	},

	// Recommended to call the instance() method instead of creating individual CheckMedia objects.
	init : function()
	{
		this.queryList = [];												// List of all the query objects that the class has.
		// We have to scope it to the object to retain instance objects.
		window.addEventListener( "resize", this.checkQueryStates.bind( this ) );
	},

	/**
	 * Creates a new query object and returns the node with the ObserverModel attached to it.
	 * @param query Condition you want to check.
	 * @memberof CheckMedia
	 */
	registerQuery : function( query )
	{

		var idValue = "_CheckMediaN" + this.queryList.length;

		var styleQuery = P("head")[0].build( "style", { id : idValue, media : query, text :"#" + idValue + "{left:1px}" } );
		this.queryList.push( styleQuery );									// We want to push the element into an array so whenever the window changes it can update the object info.

		return styleQuery;
	},

	/**
	 * Deletes the node and prevents it from being apart of the checkQueryStates update call.
	 * @param node
	 * @memberof CheckMedia
	 */
	removeQuery : function( node )
	{
		var i = this.queryList.indexOf( node );
		this.queryList.splice( i, 1 );
	},

	/**
	 * Called automatically on resize to determine what the state of the query's are, but can also be called manually if need be.
	 */
	checkQueryStates : function()
	{
		this.queryList.forEach( function( a )
		{
			if ( a.getAppliedStyle().left == "1px" )
			{
				if ( !a.wasTrue )											// Prevents the event from firing multiple times.
				{
					a.fireObservers( CheckMedia.events.ON_TRUE );
					a.fireObservers( CheckMedia.events.ON_CHANGE, true );
					a.wasTrue = true;
				}
			}
			else if ( a.wasTrue )
			{
				a.fireObservers( CheckMedia.events.ON_FALSE );
				a.fireObservers( CheckMedia.events.ON_CHANGE, false );
				a.wasTrue = false;
			}
		});
	}
};

/**
* Example test code here showing a possible mobile view check.
*
*function pageLoaded()
*{
*	var testNode = CheckMedia.instance.registerQuery("only screen and (max-width : 767px)");
*
*	testNode.addObserver(CheckMedia.events.ON_TRUE, "mobileView", this);
*	testNode.addObserver(CheckMedia.events.ON_FALSE, "leaveMobileView", this);
*
*	CheckMedia.instance.checkQueryStates(); // Tell the query system to update itself to see what its current states are.
*}
*
*function mobileView()
*{
*	console.log("mobile");
*}
*
*function leaveMobileView()
*{
*	console.log("non mobile");
*}
*
*window.addEventListener("load", pageLoaded);
**/
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="AVObj.html">AVObj</a></li><li><a href="CheckMedia.html">CheckMedia</a></li><li><a href="Node.html">Node</a></li><li><a href="Page.html">Page</a></li><li><a href="Request.html">Request</a></li></ul><h3>Global</h3><ul><li><a href="global.html#empty">empty</a></li><li><a href="global.html#node">node</a></li><li><a href="global.html#P">P</a></li><li><a href="global.html#text">text</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha9</a> on Sat Sep 27 2014 03:19:26 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
