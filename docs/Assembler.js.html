<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: AVApp/Display/Assembler.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: AVApp/Display/Assembler.js</h1>

    


    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/*
 * Copyright (c) 2014 Ian Carson - LinkedIn http://lnkd.in/9qJWap
 *
 * Project : AVObj - Making JS Simple.
 * Version : 0.6.1
 * License : MIT (http://www.opensource.org/licenses/mit-license.php)
 *
 * For the latest updates go to http://AVObject.net
 * Visit the wiki for howto information on getting started at https://github.com/Kabe0/AVObj/wiki
 */

/**
 * Created by Ian on 2014-12-15.
 */

using( AV.Utilities ).within( AV.App.Display, function( $scope )
{

	AVObjMacro( "registerEntity",
		null,
		function( object, option )
		{
			$scope.Assembler.registerAssemblerEntity( object, option.name, option.attributes );
		},
		function( option, constructorArguments )
		{
			this.super( option.name, constructorArguments[1] );
		}
	);


	/**
	 * The Assembler class handling building view's and assigning properties and events to the views.
	 * @class AV.App.Utilities.Assembler
	 */
	$scope.Assembler = AVObj.extend( { initStaticObject : true } ).prop(
	{
		regList : {},		// Stores all the assembler components based on name.
		registerAssemblerEntity : function ( component, name, attributes )
		{
			this.regList[name] = { component : component, attributes : attributes };
			console.log("registered");
		},
		/**
		 * Generates the elements based on the nodeTree instructions.
		 * @param nodeTree
		 * @param {AV.App.Utilities.Node} layer If defined, will automatically append to object.
		 */
		buildLayer : function( nodeTree )
		{
			var layerNodes 		= {};	// Stores the constructed objects as defined by the nodeTree./*
			var layerNode 	= Node.create( "layer" );

			var regExp1 = /cm-([^\s]*)/;

			console.log( nodeTree, this.regList );
			var constructArray = function( children, parent )
			{
				for( var i = 0, length = children.length; i &lt; length; i++ )
				{
					var child = children[i];

					switch( child.type )
					{
						case $scope.Parser.ELEMENT:

							// Grab all the component values
							var attributes = {}, components = [];

							for( var j = 0, jLength = child.attributes.length; j &lt; jLength; j++ )
							{
								for( var attributeName in child.attributes[j] )
								{
									if ( result = attributeName.match( regExp1 ) )
									{
										components.push( Node._componentList[result[1]].create( child.attributes[j][attributeName] ) );
									}
									else
									{
										attributes[attributeName] = child.attributes[j][attributeName];
									}
								}
							}

							if ( this.regList[child.name] )
							{
								console.log( "Construct Special", child.name );
								parent.push( this.regList[child.name].component.create( parent, components ) )

							}
							else
							{
								console.log("construct general node");
								var newNode = Node.create( child.name, components, attributes );
								parent.push( newNode );

								// If child nodes, increment through them.
								if ( child.children )
								{
									constructArray( child.children, newNode );
								}
							}

							break;
						case $scope.Parser.TEXT:

							var newText = document.createTextNode( child.text );

							parent._element.appendChild( newText );

							break;
						default:
						case $scope.Parser.UNKNOWN:
							break;
					}
				}
			}.bind(this);

			var objects = constructArray( nodeTree, layerNode );

			return layerNode;
		}
	});

	// Testing component that can be applied to the Assembler.
	$scope.NewEntity = Node.extend( { registerEntity: { name:"k", attributes:["firstName", "lastName"] } } ).prop(
		{
			init : function( parent, components, firstName, lastName )
			{

			}
		}
	);
});

/*
usingNamespace( function()
{
	namespace( AV.App.Display, function( $scope )
	{
		$scope.Assembler = AVObj.extend( { initStaticObject : true } ).prop(
		{
			init : function()
			{

			}
		});
	});
});*/</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="AV.App.Display.Template.html">Template</a></li><li><a href="AV.App.Utilities.Assembler.html">Assembler</a></li><li><a href="AV.App.Utilities.Component.html">Component</a></li><li><a href="AV.App.Utilities.Node.html">Node</a></li><li><a href="AV.Utilities.Node.html">Node</a></li><li><a href="AV.Utilities.Page.html">Page</a></li><li><a href="AV.Utilities.Request.html">Request</a></li><li><a href="AVObj.html">AVObj</a></li><li><a href="CodeDecorator.CodeDecorator.html">CodeDecorator</a></li></ul><h3>Namespaces</h3><ul><li><a href="AV.html">AV</a></li><li><a href="AV.App.html">App</a></li><li><a href="AV.Utilities.html">Utilities</a></li></ul><h3>Global</h3><ul><li><a href="global.html#AVObjMacro">AVObjMacro</a></li><li><a href="global.html#buildLayer">buildLayer</a></li><li><a href="global.html#buildTemplate">buildTemplate</a></li><li><a href="global.html#checkQueryStates">checkQueryStates</a></li><li><a href="global.html#convertToForm">convertToForm</a></li><li><a href="global.html#convertToString">convertToString</a></li><li><a href="global.html#enable">enable</a></li><li><a href="global.html#fireFunction">fireFunction</a></li><li><a href="global.html#getLayerInstruct">getLayerInstruct</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#Interpreter">Interpreter</a></li><li><a href="global.html#kill">kill</a></li><li><a href="global.html#LayerTransitionBase">LayerTransitionBase</a></li><li><a href="global.html#namespace">namespace</a></li><li><a href="global.html#pushLayer">pushLayer</a></li><li><a href="global.html#Template">Template</a></li><li><a href="global.html#usingNamespace">usingNamespace</a></li><li><a href="global.html#View">View</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha9</a> on Fri Jan 09 2015 01:19:24 GMT-0500 (Eastern Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
